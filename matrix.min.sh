#!/bin/bash
A="\033[";B=$(tput cols);C=$(tput lines);K(){ kill $(jobs -p);L "${A}2J${A}0M${A}H${A}?25h";};L(){ echo -e $1;};M(){ if(($4>200))&&((RANDOM%10>=9));then L "${A}$2;$1H${A}97m$3";else L "${A}$2;$1H${A}38;2;0;$4;0m$3";fi;};N(){ echo -e "${A}$2;$1H ";};O(){ E=$((RANDOM%C));F=$((RANDOM%20+10));sleep $(echo "scale=4;${rand}.0/32767.0/4"|bc); for((;;)); do for((I=0;I<F;I++)); do G=$((E-I));if((G<0));then G=$((G+C));fi;H=$((G-1));if((H<0));then H=$((H+C));fi;J=$(printf '%x\n' $((0x30a0+RANDOM%95)));N $1 $H;M $1 $G "\u${J}" $((255-255*I/F));done;((E=(E+1)%C));sleep 0.01;done;};trap K SIGINT;L "${A}2J${A}0M${A}?25l";for((I=0;I<B/3;I++)); do O $((I*3)) & done;wait